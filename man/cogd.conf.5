.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{
.    if \nF \{
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "COGD 5"
.TH COGD 5 "2014-09-15" "Clockwork v2.3.0" "Clockwork Manual"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
cogd.conf \- Clockwork Agent configuration file
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fB/etc/clockwork/cogd.conf\fR
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBcogd\fR(1) reads its configuration from
\&\fI/etc/clockwork/cogd.conf\fR (unless a different file is
specified with the \-c option).
.PP
Valid configuration directives, and their meanings, are as follows:
.IP "\fBmaster.\fR\fIN\fR \- Master Servers" 4
.IX Item "master.N - Master Servers"
Master Servers are the fixed points in the Clockwork architecture.
They maintain the global manifest and are solely responsible for
handing out policy to managed hosts.
.Sp
Each master server must be specified by its endpoint \s-1IP\s0 address
and \s-1TCP\s0 port number.  The standard Clockwork port for master
servers is \s-1TCP/2314.\s0
.Sp
A single \fBcogd\fR can be configured with up to 8 master servers,
\&\fBmaster.1\fR, \fBmaster.2\fR ... \fBmaster.8\fR.  It will
round-robin between these master servers until it finds one it can
connect to.  This can be leveraged to provide more resiliency into
core of your configuration management layer.
.Sp
At least one master server (\fBmaster.1\fR) must be specified, or
.Sp
\&\fBcogd\fR will exit with an error.
.IP "\fBcert.\fR\fIN\fR \- Master Server Certificates" 4
.IX Item "cert.N - Master Server Certificates"
Each master server must be authenticated by providing the cogd
clients with their public certificate (which contains only the
public key).
.IP "\fBmesh.control\fR \- Mesh Control Channel" 4
.IX Item "mesh.control - Mesh Control Channel"
.PD 0
.IP "\fBmesh.broadcast\fR \- Mesh Broadcast Channel" 4
.IX Item "mesh.broadcast - Mesh Broadcast Channel"
.PD
Each \fBcogd\fR can register with a Clockwork Mesh server, to which
it will subscribe for inbound orchestration and remote queries.
There are two channels that must be set up for this to work.
.Sp
The \fIbroadcast\fR channel is what \fBcogd\fR listens to for
inbound commands that are sent to all nodes simultaneously.  It
usually runs on port 2316.
.Sp
The \fIcontrol\fR channel is where \fBcogd\fR sends the results of
any commands or queries it has executed, so that they can be related
back to the original requester.  This is usually port 2315.
.IP "\fBsecurity.cert\fR \- Client Certificate" 4
.IX Item "security.cert - Client Certificate"
Since all communication between \fBcogd\fR and \fBclockd\fR is encrypted,
the client must have a public/private keypair, which is contained inside of
its combined certificate.
.IP "\fBtimeout\fR \- Timeout for Master Server communication" 4
.IX Item "timeout - Timeout for Master Server communication"
When communicating with master server(s), there is a chance that
the remote peer is not up or accepting connections.  Due to the
asynchronous nature of the Clockwork protocol, \fBcogd\fR must
enforce timeouts on replies from each master that it talks to.
.Sp
This configuration directive specifies that timeout, in seconds.
.Sp
Defaults to \fI5\fR.
.IP "\fBinterval\fR \- How often to run configuration management" 4
.IX Item "interval - How often to run configuration management"
Defaults to \fI300\fR (5 minutes).
.IP "\fBgatherers\fR \- Path or shell glob to gatherer script(s)" 4
.IX Item "gatherers - Path or shell glob to gatherer script(s)"
Gatherers allow this host to collect as much information about
itself as possible, and communicate that to the policy master.
This data includes stuff like kernel version, number of
interfaces, distribution name, etc., and allows the policy master
to tailor a policy specific to this host.
.Sp
To specify more than one script (the most common case), use a
shell glob.  For example, if you keep multiple gatherers in
/opt/clockwork, set \fBgatherers\fR to \*(L"/opt/clockwork/*\*(R".
.Sp
Only files with the executable bit set will be seen as valid
gatherer scripts.
.Sp
Defaults to \fI/etc/clockwork/gather.d/*\fR.
.IP "\fBcopydown\fR \- Root directory for copydown" 4
.IX Item "copydown - Root directory for copydown"
When \fBcogd\fR starts up, the first thing it does after
contacting a master server is perform a \fB\s-1COPYDOWN\s0\fR.  During
the step, static files (usually gatherer scripts) will be copied
down from the master to the local node.  This ensures that the
policy generated is correct, and that local fact gatherers are not
tampered with.
.Sp
This setting lets you choose where the copydown files are stored.
.Sp
Defaults to \fI/etc/clockwork/gather.d\fR.
.IP "\fBpidfile\fR \- \s-1PID\s0 file for storing the daemon process \s-1ID\s0" 4
.IX Item "pidfile - PID file for storing the daemon process ID"
Defaults to \fI/var/run/cogd.conf\fR.
.IP "\fBlockdir\fR \- Where to store coordination locks" 4
.IX Item "lockdir - Where to store coordination locks"
Certain actions that \fBcogd\fR performs should only be executed
by a single process at any given point in time.  To help coordinate
this, and still enable one-off runs, \fBcogd\fR creates lock files
that serve as advisory locks to other \fBcogd\fR processes.
.Sp
This setting lets you relocate the directory where these lock files
are created.  Note that anyone wishing to run \fBcogd\fR must be
allowed to write to this directory.
.Sp
Defaults to \fI/var/lock/cogd\fR.
.IP "\fBdifftool\fR \- What tool to use for logging file change diffs" 4
.IX Item "difftool - What tool to use for logging file change diffs"
This command will be run, and its output logged to \s-1NOTICE,\s0 whenever
cogd changes a local file from a remote source.  It should print out
the key differences between the two versions, to assist system owners
in troubleshooting proper policy enforcement.
.Sp
Whatever program you specify must be able to take two arguments, the
first being the path to the original, local file, and the second being
the literal string \*(L"\-\*(R".  It must also be able to read the new file
from standard input.
.Sp
This models the standard diff utility, which is what most people will
probably use.  You can specify command-line options to the tool if
so desired.
.Sp
Defaults to \fI/usr/bin/diff \-u\fR.
.IP "\fBsyslog.ident\fR \- Syslog identity string" 4
.IX Item "syslog.ident - Syslog identity string"
Defaults to \fIcogd\fR.
.IP "\fBsyslog.facility\fR \- Syslog facility for logging" 4
.IX Item "syslog.facility - Syslog facility for logging"
Defaults to \fIdaemon\fR.
.IP "\fBsyslog.level\fR \- Log level" 4
.IX Item "syslog.level - Log level"
Defaults to \fIerror\fR.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
This is the default configuration, plus a single master server at
10.0.0.5:2314:
.PP
.Vb 1
\&    listen *:2304
\&
\&    master.1   10.0.0.5:2314
\&    cert.1     /etc/clockwork/certs/master.1.pub
\&
\&    security.cert  /etc/clockwork/certs/cogd
\&
\&    timeout    5
\&    interval   300
\&    gatherers  /etc/clockwork/gather.d/*
\&    copydown   /etc/clockwork/gather.d
\&
\&    lockdir          /var/lock/cogd
\&    pidfile          /var/run/cogd.pid
\&
\&    syslog.ident     cogd
\&    syslog.facility  daemon
\&    syslog.level     error
\&
\&    difftool  /usr/bin/diff \-u
.Ve
.PP
Here's a bare-bones configuration that can talk to three different
master servers, in three different 10/8 subnets (certificates have
been omitted for brevity):
.PP
.Vb 4
\&    master.1   10.100.0.5:2314  # Chicago, IL
\&    master.2   10.120.0.5:2314  # New York, NY
\&    master.3   10.140.0.5:2314  # San Jose, CA
\&    timeout 15
.Ve
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fBclockwork\fR(7), \fBclockd\fR(1), \fBclockd.conf\fR(5) and \fBcogd.conf\fR(5)
.SH "AUTHOR"
.IX Header "AUTHOR"
Clockwork was designed and written by James Hunt.

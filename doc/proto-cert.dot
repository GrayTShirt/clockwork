digraph cert {
	node [shape=rect];

	VERIFIED [label="HELLO",style=filled,fillcolor="#9acd32"];
	NOT_VERIFIED [label="ERROR/401",style=filled,fillcolor="#ff6600"];

	HELLO -> VERIFIED;
	HELLO -> NOT_VERIFIED;

	BYE1 [label="BYE"];
	BYE3 [label="BYE"];

	{node [shape=none,label="Client\n(cwcert)"];  C0; C1; C2; }
	{node [shape=none,label="Server\n(policyd)"]; S0; S1;     }

	C0 -> S0 -> C1 -> S1 -> C2;

	VERIFIED     -> BYE1;
	NOT_VERIFIED -> GET_CERT -> SEND_CERT -> BYE3;
	GET_CERT -> SEND_CERT [dir=back];

	{rank=same; C0; HELLO;                   }
	{rank=same; S0; VERIFIED;  NOT_VERIFIED; }
	{rank=same; C1; GET_CERT;  BYE1;         }
	{rank=same; S1; SEND_CERT;               }
	{rank=same; C2; BYE3;                    }

};

/************************************************************
 **** ERROR CODES *******************************************

   1xx - RESERVED (Informational)
   2xx - RESERVED (Success)
   3xx - RESERVED (Redirection)

   4xx - Client Error (server -> client)
     400 - Server Error
     401 - Certificate Required
     404 - Policy / File Not Found
     405 - Protocol Error

   5xx - Server Error (client -> server)
     500 - Client Error
     505 - Protocol Error

   6xx - RESERVED
   7xx - RESERVED
   8xx - RESERVED
   9xx - RESERVED

 ************************************************************/

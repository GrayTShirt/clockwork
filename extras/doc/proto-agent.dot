digraph agent {

	node [shape=rect];
	VERIFIED [label="HELLO",style=filled,fillcolor="#9acd32"];
	NOT_VERIFIED [label="ERROR/401",style=filled,fillcolor="#ff6600"];

	BYE1 [label="BYE"];
	BYE3 [label="BYE"];
	BYE4 [label="BYE"];

	DATA [label="DATA*"];

	{node [shape=none,label="Client\n(cwa)"];     C0; C1; C2; C3;}
	{node [shape=none,label="Server\n(policyd)"]; S0; S1; S2; S3;}

	C0 -> S0 -> C1 -> S1 -> C2 -> S2 -> C3 -> S3;

	HELLO -> NOT_VERIFIED -> BYE3
	HELLO -> VERIFIED;

	VERIFIED -> FACTS  -> POLICY -> BYE4;

	POLICY -> FILE -> DATA;
	          FILE -> DATA [dir=back];

	DATA -> BYE1;


	{rank=same; C0; HELLO;                  }
	{rank=same; S0; VERIFIED; NOT_VERIFIED; }
	{rank=same; C1; FACTS;    BYE3;         }
	{rank=same; S1; POLICY;                 }
	{rank=same; C2; FILE;     BYE4;         }
	{rank=same; S2; DATA;                   }
	{rank=same; C3; BYE1;                   }
	{rank=same; S3;                         }

};

/************************************************************
 **** ERROR CODES *******************************************

   1xx - RESERVED (Informational)
   2xx - RESERVED (Success)
   3xx - RESERVED (Redirection)

   4xx - Client Error (server -> client)
     400 - Server Error
     401 - Certificate Required
     404 - Policy / File Not Found
     405 - Protocol Error

   5xx - Server Error (client -> server)
     500 - Client Error
     505 - Protocol Error

   6xx - RESERVED
   7xx - RESERVED
   8xx - RESERVED
   9xx - RESERVED

 ************************************************************/
